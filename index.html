<!DOCTYPE html>
<html>
    <head>
        <script>
function channel(inAttrGet, inAttrSet, inIterator)
{
    itr = inIterator || function(){};
    function update(inElement)
    {
        var kvp, members, i;
        kvp = inElement.getAttribute(inAttrSet);
        if(!kvp){ return; }else{ kvp = kvp.split(":"); }
        members = document.querySelectorAll("["+inAttrGet+"^='"+kvp[0]+"']");
        if(kvp[1] == "null" && members.length){ kvp[1] = !(members[0].getAttribute(inAttrGet).split(":")[1] == "true"); }
        for(i=0; i<members.length; i++){ members[i].setAttribute(inAttrGet, kvp[0]+":"+kvp[1]); itr(members[i], kvp[0], kvp[1]); }
    }
    function handler(inEvent)
    {
        for(var i=0; i<inEvent.path.length-3; i++){ update(inEvent.path[i]); }
    }
    document.addEventListener("click", handler);
    return function(){document.removeEventListener("click", handler);}
}


function UpdateAndBlend(inElement, inAttributeOpen, inMode, inHandler)
{
    var attrCache, interrupt, expand, live, heightStart, heightFuture, heightTime;
    attrCache = "data-transition-cache";
    interrupt = inElement.getAttribute(attrCache);
    expand = !(inElement.getAttribute(inAttributeOpen) == "true");
    if(inMode == !expand){ return; } // quit if there's no state change
    if(interrupt)
    {
        inElement.style.height = expand ? interrupt.split("|")[1] : interrupt.split("|")[0];
        inElement.setAttribute(inAttributeOpen, expand);
    }
    else
    {
        live = getComputedStyle(inElement);
        heightStart = live.height;
        inElement.setAttribute(inAttributeOpen, expand);
        heightFuture = live.height;
        heightTime = live.transition;
        inElement.setAttribute(inAttributeOpen, !expand);
        inElement.clientHeight; // this property access is necessary to prevent instant collapse (not sure why)
        if(heightStart == heightFuture){ return; } // quit if there's no spatial change
        inElement.setAttribute(inAttributeOpen, expand);
        if(heightTime.substring(0, 7) == "none 0s" || heightTime.substring(0, 6) == "all 0s" || heightTime.indexOf("height 0s") != -1){ return; } // quit if there's no temporal change
        inElement.style.height = heightStart;
        inElement.addEventListener("transitionend", done);
        inElement.setAttribute(attrCache, expand ? heightStart+"|"+heightFuture : heightFuture+"|"+heightStart);
        setTimeout(function(){ inElement.style.height = heightFuture; });
    }
    function done(inEvent)
    {
        if(inEvent.target != inEvent.srcElement || inEvent.propertyName != "height"){ return; }
        inEvent.target.removeEventListener("transitionend", done);
        inEvent.target.removeAttribute(attrCache);
        inElement.style.height = "";
    }
}

        </script>
        <style>
            body
            {
                display:block;
                position:relative;
                top:0;
                left:0;
                width:100%;
                height:100%;
                margin:300px 0 0 0;
                height:3000px;
            }
            .col
            {
                position:relative;
                display:inline-block;
                box-sizing: border-box;
                height:auto;
                width:49%;
                margin:0;
                padding:0;
                border:0;
            }
            #box1
            {
                box-sizing: border-box;
                width:100px;
                height:300px;
                background:red;
                border:2px solid black;
                border-radius:10px;
            }
            #box2
            {
                box-sizing: border-box;
                width:300px;
                background:cadetblue;
                border:1px dotted yellow;
                border-radius:0;
            }
            #box3
            {
                box-sizing: border-box;
                position:absolute;
                top:0;
                left:0;
                width:0;
                height:0;
                border:1px solid red;
                transition:all 0.5s;
            }
            .lerp-layer
            {
                box-sizing: border-box;
                display:block;
                position:absolute;
                top:0;
                left:0;
                width:10px;
                height:10px;
                border: 1px solid black;
                border-radius:5px;
                transition:top 0.5s;
            }
        </style>
    </head>

    <body>


        <div class="lerp-layer">
            <div id="box3">3</div>
        </div>

        <div>
            <div class="col">
                left
                <div id="box1" onclick="match(a)">1</div>
            </div>
            <div class="col">
                right
                <div id="box2" onclick="match(b)">2</div>
            </div>
        </div>

    </body>
    <script>
        var a, b;
        a = document.querySelector("#box1");
        b = document.querySelector("#box2");
        c = document.querySelector("#box3");

        aR = a.getBoundingClientRect();
        bR = b.getBoundingClientRect();

        let match = to =>
        {
            var body = document.body.getBoundingClientRect();
            c.parentElement.style.top = -body.top+"px";
            var r = to.getBoundingClientRect();
            
            s = getComputedStyle(to);
            c.style.left   = r.left+"px";
            c.style.top    = r.top+"px";
            c.style.width  = r.width+"px";
            c.style.height = r.height+"px";
            c.style.background   = s.background;
            c.style.border       = s.border;
            c.style.borderRadius = s.borderRadius;
            c.style.opacity      = s.opacity;
        }



    </script>
</html>