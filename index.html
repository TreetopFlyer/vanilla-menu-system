<!DOCTYPE html>
<html>
    <head>
        <style>

            ul[data-open]
            {
                position:relative;
                display:block;
                margin:0;
                padding: 0;
                height:0;
                overflow:hidden;
                background:rgba(128, 128, 128, 0.5);
                border-radius:10px;
                
                    transition-property: height,   left,     opacity;
                    transition-duration: 0.3s,     0.3s,     0.3s;
                transition-timing-function: ease-out, ease-out, ease-out;
                        transition-delay: 0s,       0.5s,     0.2s;
            }
            ul[data-open='false']
            {
                left:-10px;
                opacity:0;
                transition-delay: 0.3s, 0.0s, 0.3s;
            }
            ul[data-open='true']
            {
                left:0;
            }
            ul[data-open='false'][data-threshold]
            {
                left:10px;
            }

        </style>

        <!-- tier 0 -->
        <style>
            .Tier0 > li
            {
                position:relative;
                display:inline-block;
                vertical-align:top;
            }
            .Tier0 > li > *:first-child
            {
                display: block;
                padding: 5px 10px 5px 10px;
                border-radius: 8px;
                background: #5588a1;
                color: #fff;
                text-transform: uppercase;
                text-decoration:none;
                font-weight: 100;
                font-family: sans-serif;
                font-size: 12px;
            }
            .Tier0 > li > span:before
            {
                content:"+";
            }
            .Tier0 > li > ul
            {
                position:absolute;
                top:100%;
                min-width:100%;
            }
        </style>

        <!-- tier 1-->
        <style>
            .Tier1 span, .Tier1 a
            {
                display:block;
                padding: 6px 12px 6px 12px;
                color: #fff;
                text-decoration:none;
                font-weight: 100;
                font-family: sans-serif;
                font-size: 12px;
            }
            .Tier1 ul
            {
                border-radius:0px;
            }
        </style>
    </head>
    <body>

        <nav>
            <ul class="Tier0">
                <li data-root data-branch id="root1">
                    <span data-button data-open="false">Branch</span>
                    <ul class="Tier1" data-menu data-open="false">
                        <li><a href="#">Leaf</a></li>
                        <li data-branch data-root id="root2">
                            <span data-button data-open="false">Branch</span>
                            <ul class="Tier2" data-menu data-open="false">
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                            </ul>
                        </li>
                        <li data-branch data-root id="root3">
                            <span data-button data-open="false">Branch</span>
                            <ul class="Tier2" data-menu data-open="false">
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                            </ul>
                        </li>
                        <li><a href="#">Leaf</a></li>
                        <li><a href="#">Leaf</a></li>
                    </ul>
                </li>
                <li><a href="#">Leaf</a></li>
                <li><a href="#">Leaf</a></li>
                <li data-root data-branch id="root1">
                    <span data-button data-open="false">Branch</span>
                    <ul class="Tier1" data-menu data-open="false">
                        <li><a href="#">Leaf</a></li>
                        <li data-branch data-root id="root2">
                            <span data-button data-open="false">Branch</span>
                            <ul class="Tier2" data-menu data-open="false">
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                            </ul>
                        </li>
                        <li data-branch data-root id="root3">
                            <span data-button data-open="false">Branch</span>
                            <ul class="Tier2" data-menu data-open="false">
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                            </ul>
                        </li>
                        <li><a href="#">Leaf</a></li>
                        <li><a href="#">Leaf</a></li>
                    </ul>
                </li>
                <li><a href="#">Leaf</a></li>
            </ul>
        </nav>
<style>
    [data-get] {display:none;}
    [data-get$='true'] {display: block;}

</style>
<script>
    function channel()
    {
        var attrGet = "data-get"
        var attrSet = "data-set";
        function update(inKey, inValue)
        {
            var members = document.querySelectorAll("["+attrGet+"^='"+inKey+"']");
            for(var i=0; i<members.length; i++)
            {
                var state = members[i].getAttribute(attrGet).split(":");
                var key = state[0]
                var value = state[1]=="true";
                var invert = key[key.length-1] == "!";
                if(invert){ value = !value; }// undo the invert
                value = (inValue=="null") ? (!value) : (inValue=="true");
                if(invert){ value = !value; }// put the invert back
                members[i].setAttribute(attrGet, key+":"+value);
            }
        }

        function handler(e)
        {
            var kvp = e.target.getAttribute(attrSet);
            if(!kvp){ return; }else{ kvp = kvp.split(":"); }
            update(kvp[0], kvp[1]);
        }
        
        document.addEventListener("click", handler);
        return function(){document.removeEventListener("click", handler);}
    }
    var unbind = channel();
</script>
<div>
    <button data-set="menu1:null">
        <span data-get="menu1!:true">On</span>
        <span data-get="menu1">Off</span>
    </button>
    <div data-get="menu1">
        menu
    </div>
</div>

<script src="treemenu.js"></script>
<script>
TreeMenu({
      Open:"data-open",
      Live:"data-bind",
      Root:"data-root",
    Branch:"data-branch",
      Menu:"data-menu",
    Button:"data-button"
});
</script>

    </body>
</html>