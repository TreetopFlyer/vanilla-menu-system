<!DOCTYPE html>
<html>
    <head>
        <style>

            ul[data-open]
            {
                position:relative;
                display:block;
                margin:0;
                padding: 0;
                height:0;
                overflow:hidden;
                background:rgba(128, 128, 128, 0.5);
                border-radius:10px;
                
                    transition-property: height,   left,     opacity;
                    transition-duration: 0.3s,     0.3s,     0.3s;
                transition-timing-function: ease-out, ease-out, ease-out;
                        transition-delay: 0s,       0.5s,     0.2s;
            }
            ul[data-open='false']
            {
                left:-10px;
                opacity:0;
                transition-delay: 0.3s, 0.0s, 0.3s;
            }
            ul[data-open='true']
            {
                left:0;
            }
            ul[data-open='false'][data-threshold]
            {
                left:10px;
            }

        </style>

        <!-- tier 0 -->
        <style>
            .Tier0 > li
            {
                position:relative;
                display:inline-block;
                vertical-align:top;
            }
            .Tier0 > li > *:first-child
            {
                display: block;
                padding: 5px 10px 5px 10px;
                border-radius: 8px;
                background: #5588a1;
                color: #fff;
                text-transform: uppercase;
                text-decoration:none;
                font-weight: 100;
                font-family: sans-serif;
                font-size: 12px;
            }
            .Tier0 > li > span:before
            {
                content:"+";
            }
            .Tier0 > li > ul
            {
                position:absolute;
                top:100%;
                min-width:100%;
            }
        </style>

        <!-- tier 1-->
        <style>
            .Tier1 span, .Tier1 a
            {
                display:block;
                padding: 6px 12px 6px 12px;
                color: #fff;
                text-decoration:none;
                font-weight: 100;
                font-family: sans-serif;
                font-size: 12px;
            }
            .Tier1 ul
            {
                border-radius:0px;
            }
        </style>
    </head>
    <body>

        <nav>
            <ul class="Tier0">
                <li data-root data-branch id="root1">
                    <span data-button data-open="false">Branch</span>
                    <ul class="Tier1" data-menu data-open="false">
                        <li><a href="#">Leaf</a></li>
                        <li data-branch data-root id="root2">
                            <span data-button data-open="false">Branch</span>
                            <ul class="Tier2" data-menu data-open="false">
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                            </ul>
                        </li>
                        <li data-branch data-root id="root3">
                            <span data-button data-open="false">Branch</span>
                            <ul class="Tier2" data-menu data-open="false">
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                            </ul>
                        </li>
                        <li><a href="#">Leaf</a></li>
                        <li><a href="#">Leaf</a></li>
                    </ul>
                </li>
                <li><a href="#">Leaf</a></li>
                <li><a href="#">Leaf</a></li>
                <li data-root data-branch id="root1">
                    <span data-button data-open="false">Branch</span>
                    <ul class="Tier1" data-menu data-open="false">
                        <li><a href="#">Leaf</a></li>
                        <li data-branch data-root id="root2">
                            <span data-button data-open="false">Branch</span>
                            <ul class="Tier2" data-menu data-open="false">
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                            </ul>
                        </li>
                        <li data-branch data-root id="root3">
                            <span data-button data-open="false">Branch</span>
                            <ul class="Tier2" data-menu data-open="false">
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                                <li><a href="#">Leaf</a></li>
                            </ul>
                        </li>
                        <li><a href="#">Leaf</a></li>
                        <li><a href="#">Leaf</a></li>
                    </ul>
                </li>
                <li><a href="#">Leaf</a></li>
            </ul>
        </nav>


<style>
    [data-get] {display:none;}
    [data-get$='true'] {display: block;}

    [data-get][data-invert] {display:block;}
    [data-get$='true'][data-invert] {display: none;}
</style>
<script>
    function channel(inAttrGet, inAttrSet)
    {
        function update(inElement)
        {
            var kvp, members, i;
            kvp = inElement.getAttribute(inAttrSet);
            if(!kvp){ return; }else{ kvp = kvp.split(":"); }
            members = document.querySelectorAll("["+inAttrGet+"^='"+kvp[0]+"']");
            if(kvp[1] == "null" && members.length){ kvp[1] = !(members[0].getAttribute(inAttrGet).split(":")[1] == "true"); }
            for(i=0; i<members.length; i++){ members[i].setAttribute(inAttrGet, kvp[0]+":"+kvp[1]); }
        }
        function handler(inEvent)
        {
            for(var i=0; i<inEvent.path.length-3; i++){ update(inEvent.path[i]); }
        }
        document.addEventListener("click", handler);
        return function(){document.removeEventListener("click", handler);}
    }
    var unbind = channel("data-get", "data-set");
</script>
<div>
    <button data-set="menu1:null">
        <span data-get="menu1" data-invert>On</span>
        <span data-get="menu1">Off</span>
    </button>
    <div data-get="menu1">
        menu
    </div>
</div>



<style>
.collapse
{
    width:100px;
    height:0px;
    opacity: 0.5;
    overflow:hidden;
    background:yellow;
    border:8px solid black;
    transition:opacity 0.3s, height 1s;
}
.collapse[data-state-open='true']
{
    height:auto;
    opacity:1;
    border-color:green;
}
</style>
<div class="collapse" onclick="UpdateBlend(this, 'data-state-open', null)">
    <p>paragraph</p>
</div>
<script>
function UpdateBlend(inElement, inAttributeOpen, inMode)
{
    var interrupt, expand, live, heightStart, heightFuture;
    var inAttributeMove = "data-transition-cache";
    interrupt = inElement.getAttribute(inAttributeMove);
    expand = !(inElement.getAttribute(inAttributeOpen) == "true");
    if(inMode == !expand){ return; }
    function done(inEvent)
    {
        if(inEvent.target != inElement || inEvent.propertyName == "height"){ return; }
        inEvent.target.removeEventListener("transitionend", done);
        inEvent.target.removeAttribute(inAttributeMove);
    }
    if(interrupt)
    {
        inElement.style.height = expand ? interrupt.split("|")[1] : interrupt.split("|")[0];
        inElement.setAttribute(inAttributeOpen, expand);
    }
    else
    {
        live = getComputedStyle(inElement);
        inElement.style.height = "";
        heightStart = live.height;
        inElement.setAttribute(inAttributeOpen, expand);
        heightFuture = live.height;
        inElement.setAttribute(inAttributeOpen, !expand);
        inElement.clientHeight;
        inElement.setAttribute(inAttributeOpen, expand);
        if(heightStart == heightFuture){ return; }
        inElement.style.height = heightStart;
        inElement.setAttribute(inAttributeMove, expand ? heightStart+"|"+heightFuture : heightFuture+"|"+heightStart);
        inElement.addEventListener("transitionend", done);
        setTimeout(function(){inElement.style.height = heightFuture;});
    }
}
</script>

<!--
<script src="treemenu.js"></script>
<script>
TreeMenu({
      Open:"data-open",
      Live:"data-bind",
      Root:"data-root",
    Branch:"data-branch",
      Menu:"data-menu",
    Button:"data-button"
});
</script>
-->

    </body>
</html>