function DetectTransition(t){var e=function(e){var n,r;(n=e.target).hasAttribute(t.AttributeCheck)&&((r=(r=n.getAttribute(t.AttributeWrite))&&""!=r?JSON.parse(r):{})[e.propertyName]||(r[e.propertyName]=!0,n.setAttribute(t.AttributeWrite,JSON.stringify(r))))},n=function(e){var n,r,i;if((n=e.target).hasAttribute(t.AttributeCheck)){for(i in r=n.getAttribute(t.AttributeWrite),(r=JSON.parse(r))[e.propertyName]=!1,r)if(1==r[i])return void n.setAttribute(t.AttributeWrite,JSON.stringify(r));n.setAttribute(t.AttributeWrite,""),t.HandlerStop(n,e)}};return document.addEventListener("transitionrun",e),document.addEventListener("transitionend",n),function(){document.removeEventListener("transitionrun",e),document.removeEventListener("transitionend",n)}}function TreeMenu(t){var e=t;function n(t,e,n){null!=n&&(t.style.transition=n),t.style.height=e}function r(t,n,r){0==r&&t.setAttribute(e.Live,""),t.setAttribute(e.Open,n)}function i(t,n){return!0===n?t.getAttribute(e.Live):"true"==t.getAttribute(e.Open)}function u(t,u,a){var c,s,f,l,d;if(c=t.querySelector("["+e.Menu+"]"),s=t.querySelector("["+e.Button+"]"),u!=(d=i(c)))return l=((f=null==u?!d:u)?c.scrollHeight:0)+"px",a?(r(c,f,!1),n(c,l,"none"),setTimeout(function(){n(c,l,"")})):(r(c,f),n(c,c.clientHeight+"px",""),setTimeout(function(){var t,r;n(c,l,""),r=i(t=c)?parseInt(t.style.height):-t.scrollHeight,o(t,!1,e.Menu,function(t){i(t,!0)&&n(t,parseInt(t.style.height)+r+"px","")})})),r(s,f),f}function o(t,e,n,r){var i,u;if(e){for(i=t.querySelectorAll("["+n+"]")||[],u=0;u<i.length;u++)if(r(i[u]))return}else for(u=t.parentNode;u!=document.body;){if(u.hasAttribute(n)&&r(u))return;u=u.parentNode}}var a=DetectTransition({AttributeWrite:e.Live,AttributeCheck:e.Open,HandlerStop:function(t,r){i(t)?(t.setAttribute("data-threshold",!0),n(t,"auto","")):(n(t,"","none"),setTimeout(function(){n(t,"","")}),t.setAttribute("data-threshold",!1),o(t,!0,e.Branch,function(t){u(t,!1,!0),t.querySelector("["+e.Menu+"]").setAttribute("data-threshold",!1)}))}});function c(t){var n,r,i,a;for(t.target.hasAttribute(e.Button)&&o(t.target,!1,e.Branch,function(t){return n=t,u(t,null),!0}),r=document.querySelectorAll("["+e.Root+"]"),a=0;a<r.length;a++)if(!(i=r[a]).contains(t.target)){o(i,!1,e.Root,function(e){if(e.contains(t.target))return!0;i=e});var c=!1;o(i,!1,e.Root,function(t){if(t==n)return c=!0,!0}),c||u(i,!1)}}return document.addEventListener("click",c),function(){document.removeEventListener("click",c),a()}}